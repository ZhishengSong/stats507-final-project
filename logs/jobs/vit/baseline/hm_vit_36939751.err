2025-11-28 10:26:27 - INFO - train - Using device cuda
/home/zhisheng/hm_env/lib/python3.10/site-packages/huggingface_hub/file_download.py:942: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224 and are newly initialized because the shapes did not match:
- classifier.bias: found shape torch.Size([1000]) in the checkpoint and torch.Size([2]) in the model instantiated
- classifier.weight: found shape torch.Size([1000, 768]) in the checkpoint and torch.Size([2, 768]) in the model instantiated
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-11-28 10:26:39 - INFO - train - Epoch 1/5
/sw/pkgs/arc/python/3.10.4/pytorch/2.0.1/lib/python3.10/site-packages/torch/optim/lr_scheduler.py:139: UserWarning: Detected call of `lr_scheduler.step()` before `optimizer.step()`. In PyTorch 1.1.0 and later, you should call them in the opposite order: `optimizer.step()` before `lr_scheduler.step()`.  Failure to do this will result in PyTorch skipping the first value of the learning rate schedule. See more details at https://pytorch.org/docs/stable/optim.html#how-to-adjust-learning-rate
  warnings.warn("Detected call of `lr_scheduler.step()` before `optimizer.step()`. "
2025-11-28 10:39:35 - INFO - train - Train metrics: {
  "accuracy": 0.6341176470588236,
  "auroc": 0.5872840616133097,
  "macro_f1": 0.5226127858219374,
  "loss": 0.6498520634034101
}
2025-11-28 10:40:56 - INFO - train - Val metrics: {
  "accuracy": 0.5769230769230769,
  "auroc": 0.5369240694002739,
  "macro_f1": 0.4729057911250973,
  "loss": 0.7062933050669157
}
2025-11-28 10:41:00 - INFO - train - Saved new best checkpoint with AUROC=0.5369
2025-11-28 10:41:00 - INFO - train - Epoch 2/5
2025-11-28 10:54:05 - INFO - train - Train metrics: {
  "accuracy": 0.7235294117647059,
  "auroc": 0.7627404350685638,
  "macro_f1": 0.6693778510470668,
  "loss": 0.5463725819307215
}
2025-11-28 10:55:27 - INFO - train - Val metrics: {
  "accuracy": 0.5846153846153846,
  "auroc": 0.5408513190805482,
  "macro_f1": 0.4447273320512757,
  "loss": 0.8518138271111708
}
2025-11-28 10:55:32 - INFO - train - Saved new best checkpoint with AUROC=0.5409
2025-11-28 10:55:32 - INFO - train - Epoch 3/5
2025-11-28 11:08:41 - INFO - train - Train metrics: {
  "accuracy": 0.8278823529411765,
  "auroc": 0.9056626647059651,
  "macro_f1": 0.8064415980890179,
  "loss": 0.3863552582824931
}
2025-11-28 11:10:04 - INFO - train - Val metrics: {
  "accuracy": 0.5711538461538461,
  "auroc": 0.548720908737659,
  "macro_f1": 0.5177796906903535,
  "loss": 0.8559402621709383
}
2025-11-28 11:10:09 - INFO - train - Saved new best checkpoint with AUROC=0.5487
2025-11-28 11:10:09 - INFO - train - Epoch 4/5
2025-11-28 11:22:59 - INFO - train - Train metrics: {
  "accuracy": 0.9254117647058824,
  "auroc": 0.9783410594423604,
  "macro_f1": 0.9178167141618654,
  "loss": 0.21626803785913132
}
2025-11-28 11:24:23 - INFO - train - Val metrics: {
  "accuracy": 0.5673076923076923,
  "auroc": 0.5335098898031093,
  "macro_f1": 0.47908318640807823,
  "loss": 1.0783106157412896
}
2025-11-28 11:24:23 - INFO - train - Epoch 5/5
2025-11-28 11:37:08 - INFO - train - Train metrics: {
  "accuracy": 0.9735294117647059,
  "auroc": 0.9969102513733643,
  "macro_f1": 0.9710424355278564,
  "loss": 0.10979644227729124
}
2025-11-28 11:38:33 - INFO - train - Val metrics: {
  "accuracy": 0.5701923076923077,
  "auroc": 0.5314726997672321,
  "macro_f1": 0.4994395506068035,
  "loss": 1.1757239025372725
}
2025-11-28 11:38:33 - INFO - train - Evaluating best checkpoint on test split.
2025-11-28 11:43:15 - INFO - train - Test metrics: {
  "accuracy": 0.586,
  "auroc": 0.5622562316715543,
  "macro_f1": 0.5314046892732672,
  "loss": 0.8338208004633586
}
2025-11-28 11:43:15 - INFO - train - Saved test predictions to logs/test_predictions.csv
/home/zhisheng/hm_env/lib/python3.10/site-packages/huggingface_hub/file_download.py:942: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Repo card metadata block was not found. Setting CardData to empty.
/sw/pkgs/arc/python/3.10.4/pytorch/2.0.1/lib/python3.10/site-packages/torch/utils/data/dataloader.py:560: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Some weights of ViTForImageClassification were not initialized from the model checkpoint at google/vit-base-patch16-224 and are newly initialized because the shapes did not match:
- classifier.bias: found shape torch.Size([1000]) in the checkpoint and torch.Size([2]) in the model instantiated
- classifier.weight: found shape torch.Size([1000, 768]) in the checkpoint and torch.Size([2, 768]) in the model instantiated
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-11-28 11:46:35 - INFO - eval - Metrics: {
  "accuracy": 0.586,
  "auroc": 0.5622562316715543,
  "macro_f1": 0.5314046892732672,
  "loss": 0.8338208004633586
}
2025-11-28 11:46:35 - INFO - eval - Predictions saved to logs/vit_test_predictions.csv
