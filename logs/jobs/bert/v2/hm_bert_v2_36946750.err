Repo card metadata block was not found. Setting CardData to empty.
2025-11-28 18:03:51 - INFO - train - Using device cuda
/home/zhisheng/hm_env/lib/python3.10/site-packages/huggingface_hub/file_download.py:942: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
Repo card metadata block was not found. Setting CardData to empty.
Some weights of BertForSequenceClassification were not initialized from the model checkpoint at bert-base-uncased and are newly initialized: ['classifier.bias', 'classifier.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2025-11-28 18:04:05 - INFO - train - Epoch 1/10
2025-11-28 18:16:49 - INFO - train - Train metrics: {
  "accuracy": 0.7014117647058824,
  "auroc": 0.7155599224736071,
  "macro_f1": 0.63986059585117,
  "loss": 0.5785236026820014
}
2025-11-28 18:18:10 - INFO - train - Val metrics: {
  "accuracy": 0.5990384615384615,
  "auroc": 0.6206582387360368,
  "macro_f1": 0.5281938139080997,
  "loss": 0.729350510927347
}
2025-11-28 18:18:16 - INFO - train - Saved new best checkpoint with AUROC=0.6207
2025-11-28 18:18:16 - INFO - train - Epoch 2/10
2025-11-28 18:31:02 - INFO - train - Train metrics: {
  "accuracy": 0.7794117647058824,
  "auroc": 0.8266440198514076,
  "macro_f1": 0.7482858920745616,
  "loss": 0.4807724860555985
}
2025-11-28 18:32:23 - INFO - train - Val metrics: {
  "accuracy": 0.5903846153846154,
  "auroc": 0.6171723802302025,
  "macro_f1": 0.4806802357475419,
  "loss": 0.8459545318896954
}
2025-11-28 18:32:23 - INFO - train - Epoch 3/10
2025-11-28 18:45:03 - INFO - train - Train metrics: {
  "accuracy": 0.8191764705882353,
  "auroc": 0.8982116183347466,
  "macro_f1": 0.7994307730350523,
  "loss": 0.38080423829134774
}
2025-11-28 18:46:24 - INFO - train - Val metrics: {
  "accuracy": 0.5951923076923077,
  "auroc": 0.6193849949636135,
  "macro_f1": 0.5211299338633453,
  "loss": 0.8735867307736324
}
2025-11-28 18:46:24 - INFO - train - Epoch 4/10
2025-11-28 18:59:19 - INFO - train - Train metrics: {
  "accuracy": 0.8498823529411764,
  "auroc": 0.9385975122345924,
  "macro_f1": 0.8358649815592507,
  "loss": 0.294818723636515
}
2025-11-28 19:00:40 - INFO - train - Val metrics: {
  "accuracy": 0.5798076923076924,
  "auroc": 0.5852696070109518,
  "macro_f1": 0.5207802820614209,
  "loss": 1.024831816324821
}
2025-11-28 19:00:40 - INFO - train - Epoch 5/10
2025-11-28 19:13:28 - INFO - train - Train metrics: {
  "accuracy": 0.8691764705882353,
  "auroc": 0.9544603752950886,
  "macro_f1": 0.858606761409112,
  "loss": 0.24899696989620432
}
2025-11-28 19:14:49 - INFO - train - Val metrics: {
  "accuracy": 0.5855769230769231,
  "auroc": 0.5782337562388945,
  "macro_f1": 0.5375989684074791,
  "loss": 1.1997807062589205
}
2025-11-28 19:14:49 - INFO - train - Epoch 6/10
2025-11-28 19:27:25 - INFO - train - Train metrics: {
  "accuracy": 0.8758823529411764,
  "auroc": 0.9626442069532382,
  "macro_f1": 0.8664315862584816,
  "loss": 0.2173512548488729
}
2025-11-28 19:28:45 - INFO - train - Val metrics: {
  "accuracy": 0.5990384615384615,
  "auroc": 0.5697756450158636,
  "macro_f1": 0.5101603770707889,
  "loss": 1.5679066992723025
}
2025-11-28 19:28:45 - INFO - train - Epoch 7/10
2025-11-28 19:41:25 - INFO - train - Train metrics: {
  "accuracy": 0.8854117647058823,
  "auroc": 0.9687868096110148,
  "macro_f1": 0.876990644692046,
  "loss": 0.19566146812719457
}
2025-11-28 19:42:45 - INFO - train - Val metrics: {
  "accuracy": 0.5778846153846153,
  "auroc": 0.5565018429024677,
  "macro_f1": 0.5229213231890373,
  "loss": 1.805490922010862
}
2025-11-28 19:42:45 - INFO - train - Epoch 8/10
2025-11-28 19:55:17 - INFO - train - Train metrics: {
  "accuracy": 0.8911764705882353,
  "auroc": 0.9723583937984687,
  "macro_f1": 0.883248303202486,
  "loss": 0.17678755122773787
}
2025-11-28 19:56:38 - INFO - train - Val metrics: {
  "accuracy": 0.5855769230769231,
  "auroc": 0.5580089862716027,
  "macro_f1": 0.5349971108489955,
  "loss": 2.050451723428873
}
2025-11-28 19:56:38 - INFO - train - Epoch 9/10
2025-11-28 20:09:16 - INFO - train - Train metrics: {
  "accuracy": 0.8978823529411765,
  "auroc": 0.9759033570697628,
  "macro_f1": 0.8911358558415632,
  "loss": 0.16141374939329484
}
2025-11-28 20:10:37 - INFO - train - Val metrics: {
  "accuracy": 0.5836538461538462,
  "auroc": 0.5503242527473771,
  "macro_f1": 0.530133065664718,
  "loss": 2.2471625942450304
}
2025-11-28 20:10:37 - INFO - train - Epoch 10/10
2025-11-28 20:23:32 - INFO - train - Train metrics: {
  "accuracy": 0.8996470588235295,
  "auroc": 0.9777791798328399,
  "macro_f1": 0.8932092088672192,
  "loss": 0.15391307505439308
}
2025-11-28 20:24:54 - INFO - train - Val metrics: {
  "accuracy": 0.5894230769230769,
  "auroc": 0.5491773902086611,
  "macro_f1": 0.5242212401232087,
  "loss": 2.4586865085821885
}
2025-11-28 20:24:54 - INFO - train - Evaluating best checkpoint on test split.
2025-11-28 20:29:26 - INFO - train - Test metrics: {
  "accuracy": 0.6246666666666667,
  "auroc": 0.6514089992668622,
  "macro_f1": 0.553457885711657,
  "loss": 0.6939873938163121
}
2025-11-28 20:29:26 - INFO - train - Saved test predictions to logs/test_predictions.csv
